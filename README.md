# Arduino Serial Data Reader

Python-скрипт для чтения и обработки данных с Arduino через последовательный порт (UART).

## Описание

Этот проект предоставляет Python-скрипт для чтения структурированных данных с Arduino. Скрипт:
- Устанавливает соединение через последовательный порт
- Читает пакеты данных с проверкой контрольной суммы CRC8
- Парсит и отображает полученные данные
- Отслеживает разрывы соединения

## Протокол передачи данных

Скрипт ожидает пакеты в следующем формате:
- Стартовый байт: `0xA5`
- Размер данных: 1 байт (до 252)
- CRC8 контрольная сумма: 1 байт
- Данные: N байт

Формат данных (6 байт):
- Sequence number: 2 байта (uint16)
- Значение 1: 2 байта (uint16)
- Значение 2: 2 байта (uint16)

## Требования

- Python 3.x
- pyserial

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/Bozedan/arduino.git
cd arduino
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Использование

1. Подключите Arduino к компьютеру
2. Измените порт в скрипте если необходимо (по умолчанию `/dev/ttyACM0`):
```python
port = "/dev/ttyACM0"  # Linux
# port = "COM3"        # Windows
```

3. Запустите скрипт:
```bash
python arduino_receive.py
```

Скрипт будет работать 90 секунд и выводить полученные данные в формате:
```
sequence_number    value1    value2    disconnects_count
```

## Настройка

### Параметры подключения:
```python
port = "/dev/ttyACM0"  # Последовательный порт
baudrate = 115200      # Скорость передачи данных
```

### Параметры работы:
- `skip`: количество пакетов для пропуска в начале (по умолчанию 100)
- Время работы: 90 секунд (можно изменить в последней строке)

## Структура проекта

```
arduino/
├── arduino_receive.py  # Основной скрипт для чтения данных
├── README.md          # Документация
└── requirements.txt   # Зависимости Python
```

## Arduino код

Для использования этого скрипта, ваш Arduino должен отправлять данные в указанном формате через Serial.

Пример кода для Arduino:
```cpp
void sendPacket(uint16_t seq, uint16_t val1, uint16_t val2) {
    uint8_t packet[9];
    packet[0] = 0xA5;  // Start byte
    packet[1] = 6;     // Data size
    
    // Data
    packet[3] = seq & 0xFF;
    packet[4] = (seq >> 8) & 0xFF;
    packet[5] = val1 & 0xFF;
    packet[6] = (val1 >> 8) & 0xFF;
    packet[7] = val2 & 0xFF;
    packet[8] = (val2 >> 8) & 0xFF;
    
    // Calculate CRC8
    packet[2] = calculateCRC8(&packet[3], 6);
    
    Serial.write(packet, 9);
}
```

## Отладка

Если данные не приходят:
1. Проверьте правильность порта
2. Убедитесь, что скорость передачи данных совпадает на Arduino и в скрипте
3. Проверьте права доступа к порту (Linux: `sudo chmod 666 /dev/ttyACM0`)
4. Убедитесь, что Arduino отправляет данные в правильном формате

## Лицензия

MIT

## Автор

Bozedan 